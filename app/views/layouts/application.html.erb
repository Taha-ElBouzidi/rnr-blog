<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "First" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="First">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    
    <style>
      * { box-sizing: border-box; }
      body { 
        margin: 0; 
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #2d3748;
      }
      .container { 
        max-width: 1200px; 
        margin: 0 auto; 
        padding: 0 1.5rem;
      }
      .card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        padding: 2rem;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 25px 70px rgba(0,0,0,0.2);
      }
      .btn {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        border: none;
        cursor: pointer;
        font-size: 0.95rem;
      }
      .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
      .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
      .btn-success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; }
      .btn-danger { background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%); color: white; }
      .btn-secondary { background: #e2e8f0; color: #4a5568; }
      .btn-warning { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
    </style>
  </head>

  <body>
    <header style="background: rgba(255,255,255,0.98); backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,0.1); padding: 1.25rem 0; margin-bottom: 3rem; position: sticky; top: 0; z-index: 1000;">
      <nav class="container" style="display: flex; align-items: center; justify-content: space-between;">
        <div style="display: flex; align-items: center; gap: 2rem;">
          <h1 style="margin: 0; font-size: 1.75rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700;">
            <%= link_to "âœ¨ Blog", posts_path, style: "background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-decoration: none;" %>
          </h1>
          <% if current_user %>
            <div style="display: flex; gap: 0.75rem;">
              <%= link_to "ðŸ  Home", posts_path, class: "btn btn-secondary", style: "padding: 0.5rem 1rem; font-size: 0.9rem;" %>
            </div>
          <% end %>
        </div>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <% if current_user %>
            <div style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 20px; color: white; font-weight: 500; font-size: 0.9rem;">
              ðŸ‘¤ <%= current_user.name %>
            </div>
            <%= button_to "Logout", logout_path, method: :delete, class: "btn btn-danger", style: "padding: 0.5rem 1rem; font-size: 0.9rem;" %>
          <% else %>
            <%= link_to "Login", login_path, class: "btn btn-primary" %>
          <% end %>
        </div>
      </nav>
    </header>

    <% if flash.any? %>
      <div class="container" style="margin-bottom: 2rem;">
        <% flash.each do |type, message| %>
          <div style="padding: 1.25rem 1.75rem; border-radius: 14px; display: flex; align-items: center; gap: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,0.15); animation: slideIn 0.4s ease; <%= type == 'notice' ? 'background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); color: #155724; border-left: 5px solid #28a745;' : type == 'alert' ? 'background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); color: #721c24; border-left: 5px solid #dc3545;' : 'background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%); color: #0c5460; border-left: 5px solid #17a2b8;' %>">
            <span style="font-size: 1.75rem;"><%= type == 'notice' ? 'âœ…' : type == 'alert' ? 'âš ï¸' : 'â„¹ï¸' %></span>
            <span style="font-weight: 500; font-size: 1.05rem;"><%= message %></span>
          </div>
        <% end %>
      </div>
    <% end %>

    <main style="padding-bottom: 4rem;">
      <%= yield %>
    </main>
    
  </body>
</html>
